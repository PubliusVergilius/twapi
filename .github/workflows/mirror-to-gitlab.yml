# .github/workflows/mirror-to-gitlab.yml
- name: Checkout full history
  uses: actions/checkout@v3
  with:
    fetch-depth: 0  # ðŸ‘ˆ Required for full history (not shallow)

- name: Push branches to GitLab
  on:
    push:
      branches:
        - develop

  env:
    GITLAB_TOKEN: ${{ secrets.GITLAB_TOKEN }}
  jobs:
    mirror:
      runs-on: ubuntu-latest
      environment: GitlabToken
      steps:
        - name: Clone GitHub repo
          uses: actions/checkout@v3

        - name: Push to GitLab
          run: |
            git config --global user.name "vinteesetedemaiodedoismil"
            git config --global user.email "vinteesetedemaiodedoismil@gmail.com"
            # git remote add origin git@gitlab.com:vinteesetedemaiodedoismil/twapi.git
            git remote add gitlab https://vinteesetedemaiodedoismil:${{ secrets.GITLAB_TOKEN }}@gitlab.com/vinteesetedemaiodedoismil/twapi.git
            git push --mirror gitlab
        - name: Check secret presence
          run: |
            echo "GitLab token set: ${GITLAB_TOKEN+x}"

